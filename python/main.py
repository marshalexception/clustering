import os

from sklearn.metrics.pairwise import pairwise_distances
from sklearn.metrics import silhouette_score
import numpy as np
from numpy import genfromtxt
import matplotlib.pyplot as plt

#need to install pytest: python -m pip install pytest

from algorithms import kMedoid
import csv

#data = np.array([[1,1,1],[2,2,2], [10,10,10]])

#data = np.array(([-0.02401555571705103,-0.032500221487134696,-0.01461782231926918,0.0625750757753849,-0.01257991436868906,-0.036221329122781754,0.02757938914000988,-0.008495347201824188,0.04031916745007038,0.08598813638091088,-0.01928800866007805,-0.022666817903518675,-0.033965794299729166,0.026593169756233694,-0.009651998057961464,0.050882675871253016,0.08287690952420235,0.017847822280600667,0.016702423244714736,-0.010879958420991898,-0.0020148690789937975,-0.0026396822184324266,0.07472366467118263,-0.024030596250668168,0.012193202227354049,0.0021182068157941103,-0.027017583977431057,0.010668407380580901,-0.009780049696564675,0.015996949188411234,0.0015620652120560408,0.01601375248283148,-0.04230548217892647,0.032695727050304414,0.03955783313140273,-0.0396759457886219,0.014875450823456048,-0.026083537749946116,-0.0036588162678526715,0.054382073367014526,0.08585151210427285,0.03020429741591215,0.06845229757018387,-0.049649609997868535,-0.027311598882079124,-0.010589430015534163,0.03477447247132659,0.03266829401254654,-0.010023079160600901,-0.02095197088783607,0.04367610923945904,-0.003040639031678438,0.007202761666849256,-0.0247829906642437,0.019982567802071572,0.007147813343908638,-0.0034630246460437774,0.0038727525621652602,0.01622929714358179,-0.027422930207103492,-0.021291491761803626,0.02297060638666153,-0.04225277230143547,0.04813862591981888,0.010096999630331994,-0.04276629276573658,-0.024007815110962838,0.06533808540552855,0.017181940749287604,0.03548228740692139,-0.005365296034142375,-0.01768281767144799,0.05620585288852453,-0.03568554744124412,-0.0388864953070879,-0.03465363755822182,0.05679274294525385,0.059571311436593534,-0.026729770004749298,0.03254539389163256,0.0456421310082078,-0.04152228720486164,-0.025360623747110365,-0.0029189220629632475,-3.07328999042511E-4,-0.009920499660074711,-0.04466196857392788,0.05196760073304176,-0.012506990507245064,0.005083981761708855,0.032713660039007664,0.027676244266331196,-0.020859074685722588,-0.053433327749371526,0.03857981413602829,-0.046772848814725876,0.0013031775131821632,0.004811785556375981,-0.005157906748354435,-0.02946273284032941,0.027353815361857416,-0.056043971329927444,0.022240135353058577,0.019527990894857794,-0.022759213298559188,-0.03559908345341682,-0.025886067003011704,-0.034783368557691575,-0.004133414896205068,-0.02599291494116187,-0.004266945365816355,-0.00660597481764853,4.0122931823134423E-4,0.011820323392748832,0.0046459145843982695,-0.03086609821766615,0.033538825996220115,-0.0537374135106802,0.06244838386774063,0.02495885659009218,0.026246128231287004,-0.003959208354353904,-0.028105771541595458,0.04584338925778866,0.008405829221010208,-0.022801475133746862,-0.023879408091306686,-0.044204935617744925,0.023881371319293975,-0.01452520713210106,0.024783946201205255,-0.016067272750660777,-0.022788991034030915,-0.01744532734155655,-0.053720587864518166,-0.007496863789856434,0.03176253632409498,-0.018543822318315507,-0.0452486053109169,0.043116502650082114,0.007946699019521474,-0.04717647507786751,0.003931440971791744,0.02385254353284836,0.007998253960977308,-0.011492808535695075,0.0024499129503965378,7.998700020834804E-4,-0.06287100650370121,-0.023171237856149673,-0.01695238072425127,0.01873764565680176,-0.032244704128243026,-0.015670545026659967,0.033569757081568244,0.023245427757501602,-0.006400338187813759,-0.03482310436666012,-0.009921015426516532,-0.036040795221924785,-0.02848643288016319,0.0315880935639143,0.02316198982298374,0.018440777371870352,0.011922801099717616,-0.008362407889217138,0.0020305395126342775,-0.020667486637830735,-0.005567147070541978,-0.0023435840383172037,-0.09805061072111129,-0.057678085565567014,-0.009338581562042236,-0.044593929499387744,-0.031071596220135687,-0.0592137947678566,0.004766051284968853,-0.051737499237060544,-0.024757416173815727,0.06711216792464256,-0.03935037739574909,-0.020266322791576384,0.02912323661148548,0.06669268235564232,0.0020291127264499666,-0.05468783862888813,0.011342787370085716,0.05230332491919398,0.01928295074030757,0.04403998861089349,-0.012076495913788676,0.008150434121489525,0.021007257886230944,-0.007915554754436015,-0.04967360571026802,0.004360765218734741,0.014590203762054443,-0.004048815090209245,0.014909164141863584,-0.03912634439766407,0.03136659376323223,0.0209891052916646,-0.05007284209132194,-0.02615448795258999,0.007520225830376148,-0.02340071478392929,-0.01704711690545082,-0.05060622896999121,0.05094298599287868,0.021396061219275,-0.0021772652864456175,-0.010443704575300217,0.022314093075692654,0.055203672125935556,-0.04417770504951477,0.048659931495785715,0.0360648587346077,0.01429827455431223,-0.06884729713201523,-0.001351313479244709,0.03824913650751114,0.014324251934885979,-0.02321113795042038,-0.04528425931930542,0.03565788809210062,0.01325558014214039,-0.0025809370912611485,0.007415866851806641,7.564213126897811E-4,-0.01835920996963978,0.029606769606471062,-0.0230287604033947,0.02477784939110279,0.02442618990316987,0.013273505121469497,0.02106971014291048,0.040633019804954526,-0.03067992366850376,0.026524560153484346,-0.01682989872060716,-0.015383592247962952,0.02940311413258314,0.025415901839733124,-0.00876533124828711,-0.007888672687113286,0.025300056021660567,1.5954747796058654E-4,-0.02801245413720608,-0.0074668355286121365,-0.03287039641290903,-0.005763297528028488,0.011668350920081139,-0.006584997102618217,0.056765148881822824,0.013172844517976045,0.03064025929197669,0.02966059185564518,0.03276207372546196,-0.006618030974641443,7.633060216903686E-4,0.025683361291885375,-0.027788642048835754,0.009481022134423256,0.05193040752783418,0.03981158919632435,0.07554168254137039,-0.018328918144106865,-0.004651551507413388,0.05391118694096804,-0.0167168146930635,0.040302078356035054,0.0835092969238758,0.061511519737541674,0.041392377205193044,0.023658012226223945,0.029094187170267106,-0.02713648620992899,-0.0351265212520957,0.022992505220463498,-0.05115417018532753,0.020160933956503868,0.021759345568716525,0.037974989414215087,0.017129191756248476,0.020969712734222413,-0.004677113308571279,-0.0036350272595882414,0.02906748577952385,0.014101331308484077,0.06502798888832331,-0.05311189666390419,0.0133082315325737,-0.017672499269247056,0.02886971510015428,0.03364629596471787,-0.002081855293363333,-0.0029273682273924352,-0.027618969883769752,0.050873357336968184,-0.043582138046622275],
#                [0.013477697071849811,0.010405044587087381,0.02273985201838624,0.05550221046503408,-0.01865269794749717,-0.00386846839741926,0.029913286994813444,-0.03368328691864706,0.03374278295924534,0.010093439645851219,-0.01887104097730833,-0.04420007767644946,-0.024905116506617028,0.013888393022529217,-0.04596139336530486,0.024599072510480054,0.025334450754341716,0.024783026483474357,0.008896435535103647,-0.0197644054666963,-0.017533293608464347,0.007905497285655013,-0.001683197125193964,-0.011163129119644637,0.014820889691084934,-0.015650692755695094,-0.05095015437756148,0.024425396844485983,-0.008224519260105385,0.02210770550715611,-0.004257128209862246,9.909683510407128E-4,-0.018688531248533927,0.009268655826812704,0.020834452243324256,-0.009915260349945965,0.001873985679456823,-0.006130421479500717,0.007703628480984745,0.027593926075055744,0.04686432756304816,0.0018063257895221914,0.04441750641074972,-0.02168825097297403,-0.004968313983585121,-0.015077669147030239,0.0030975634557891146,0.024616471962118993,0.0021092044083740225,0.004363387100506724,0.012979822701332395,0.001686663710992287,0.001370380028160383,-0.01422423235084297,0.006982167783287951,0.02274876545392673,-0.023643223347725593,-0.018337002094021313,0.02040803349261452,-0.030447809179689773,-0.018683782706802682,0.02035477152094245,-0.039319599790479796,-0.048549205170605673,-0.010891806857538117,-0.003383633307877439,-0.019025136118124456,0.04567827720364386,-0.02360520975880626,0.03035608839803385,3.8860927481731083E-4,0.013055770332228881,0.049608804455004644,0.009073373714621847,-0.044820015899592426,-0.02912790906107561,0.05527415276134494,0.058183247874951875,0.013771433698076924,0.04388102059925182,0.009940311216250663,-0.033215542627272734,0.0052115109977632825,0.01320527520940893,-0.03557463786141439,-0.030070056013599498,-0.04299141406293281,0.05589155875607347,-0.008598198728504204,0.00984141697655573,0.021473984475685,0.004180857719076831,-0.03198817790006146,-0.06449570148157878,0.004243101460172447,-0.030104063096164604,0.019118027338250118,0.014898896501329022,-0.0023356113327676524,-0.0025057346013849695,-0.0036906956014019963,-0.04039248041843883,-0.008699761710445411,0.0018510645028495352,-0.029131058942187916,-0.015651111693207924,-0.016465579557604148,-0.026238906970706233,0.018776079792955026,-0.043642347219936324,-0.016969649375162342,0.0015907891700573434,-0.0168854578855598,0.006615051529323211,0.032844697749665516,0.013430527937401562,0.0313640920365361,-0.01180552436518624,0.04231357069643722,0.025245476584067814,-0.04182971194310048,0.00738057307487429,-0.024512730616749256,0.033233796652627524,-0.030233407973998573,-0.01612151952665017,-0.007284494117343318,-0.02342794399539178,0.011293645705933672,0.019924566311987513,-0.0012573482673920954,-0.03900281635625758,-0.04795192951110728,-0.029661880333371686,-0.0068071986821414245,-0.04312582132188989,0.01581441385570368,-0.0014654389921237123,-0.004926577317728332,0.021432454098660424,0.009519956770795162,-0.041268780345398215,0.019838294857904795,0.010265119356747641,0.019388126947851192,0.010577143279510662,-0.02372802889320872,-0.022815632236406508,-0.019210472809207187,0.010858778966734223,0.025348100377331404,0.01771398459095508,-0.04722562620501243,0.012222044557953874,0.0014567837669429455,-0.007058543388289634,-0.025028138830105427,-0.03151740525208879,-0.031048189428860718,-0.006636248320291722,-8.883650786233972E-4,0.03478053328816337,0.015338117043920463,0.021662656599985,0.005492329462537204,-0.009760875387747555,0.024947134834935304,-0.0023867843376891218,0.009347316618647775,-0.01769414020648151,-0.04929406055004684,-0.01707591888260489,-0.02131830274381421,-0.03582785957060152,-0.006077467682630275,-0.008546816272134281,0.02280718115938303,-0.03635435188136233,-0.02226427931534338,0.011282755927455545,-0.03632058411033476,-0.03656244212632171,-0.0012793306032659584,0.0014138147164361947,-0.007619146073020694,-0.010188979253988957,9.820781685788223E-4,0.0062608195657223335,0.04805998619812814,0.02012789453176377,0.006240825014082465,0.004369203304646142,0.007585347458106381,0.008336526411115144,-0.04049239399127963,0.005305120298130946,-0.002986730168681742,-0.01779141200228942,-0.024193996175502736,-0.06621745692547222,0.007937470118802116,0.033363028046689135,0.0035836916959860994,-0.0046212365151138395,-0.008520613201056617,-0.012249392852412931,-0.021702885060956835,-0.014733972207224466,0.014722745992287975,-0.004057620868387848,0.006199104606757185,0.017991613400300418,-0.002517876844392205,0.024534609055880344,-0.05049941343057788,0.014295457502488385,0.03915319471699985,0.0020071982036843294,-0.04714657901786268,0.001020843439472068,-0.004483466584776643,-0.011066562835964364,3.102444373353413E-4,-0.021553796596752803,0.030193012080747973,-0.010337867047355481,0.02487121475625294,0.015078880451972398,0.016234840101778808,0.024276049038621062,0.01673335931734229,-0.02506104046996269,0.029143655818666278,0.010047779546996503,0.020964723170941904,-0.015346316730655316,0.010353160677524753,-0.02101381969958017,0.018563889513542462,0.004034599569165195,0.007240880992160075,-0.010898858418739919,0.0195679735272389,-0.04104919669881576,-6.24892665214385E-4,-0.006447576770718878,0.01079449448452303,0.021163192523568117,-0.014140827435179321,-0.014473916927171458,0.007219867679382194,0.008904095252298495,0.019390621277529538,0.025138081745564998,0.021687459083029416,-0.017680103110379982,0.03204403216541966,0.026167800412466278,-0.0373386572252705,-0.0036015171378926195,0.009512080509930548,-0.004619823207824745,-0.029311207348508454,0.03108262379460902,0.015589996198700233,0.051697680343299954,-0.006937932776936302,6.796259314263936E-5,-0.026990887850071445,0.0028855355322417436,0.03815491270977119,0.02197740197997785,0.04955234792967788,0.023508775278436717,0.02447512426420651,-0.035200134615855985,-0.021897382268710346,-0.05681072716099078,-0.011537180272768241,-0.009407506898196057,0.01025375273346788,5.219668712034219E-4,0.008363764583147273,0.04222308224401639,4.5351159901151224E-4,0.011364358698365966,-0.02038341356422858,-0.010409036668892386,0.021163463860637312,0.019340824203523385,-0.054048151564649115,0.01837349933045305,-0.029180901473143485,0.007644186770035462,-0.009673327285175523,0.016652890658617546,6.848351790033506E-4,-0.014127901040318639,0.015550917533277463,-0.022127802838862995]));

data = genfromtxt('vectors.txt', delimiter=";")

# distance matrix
D = pairwise_distances(data, metric='euclidean')

DD = genfromtxt('matrix.txt', delimiter=";")
#print(X)


# split into 2 clusters
M, C = kMedoid.kMedoids(D, 14)
#labels = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
#plt.scatter(C, 50)

print('medoids:')
for point_idx in M:
    print(point_idx)

print('')
print('clustering result:')
for label in C:
    for point_idx in C[label]:
        print("Graph:", point_idx, "Cluster:", label)

#print(silhouette_score(D))
 #      print('label {0}:　{1}'.format(label, data[point_idx]))

#file = open("matrix_pfister.txt", "r+")
#txt = file.read()
#print(txt)

######################################
#CSV
#https://stackoverflow.com/questions/37400974/unicode-error-unicodeescape-codec-cant-decode-bytes-in-position-2-3-trunca
        #if line_count == 0:
        #    print(f'Column names are {", ".join(row)}')
        #    line_count += 1
        #else:
        #    print(f'\t{row[0]} works in the {row[1]} department, and was born in {row[2]}.')
        #    line_count += 1
        #print(f'Processed {line_count} lines.')

######################################